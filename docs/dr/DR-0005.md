# DR-0005. Отсутствие автоматизированных тестов

## Заголовок
Полное отсутствие автоматизированных тестов в проекте

## Контекст
Проблема обнаружена во всей кодовой базе проекта - в корневой директории отсутствует директория tests/, и не найдено ни одного файла с тестами. Однако:
1. В `pyproject.toml` указаны зависимости для тестирования (pytest, pytest-aiohttp, pytest-asyncio)
2. В конфигурации ruff настроены правила для тестов
3. В ADR-0007 описана стратегия тестирования

Эта проблема затрагивает качество кода, надежность изменений и скорость разработки. Проблема была идентифицирована как технический долг в TDR-0005 и как серьезная проблема в PDR-0005.

## Проблема / Долг
В проекте полностью отсутствуют автоматизированные тесты:
- Нет unit-тестов для отдельных функций и классов
- Нет интеграционных тестов для проверки взаимодействия компонентов
- Нет end-to-end тестов для проверки полных сценариев работы
- Нет тестов для API-эндпоинтов
- Нет тестов для Telegram-бота

Отсутствие тестов делает изменение кода рискованным, так как невозможно быстро проверить, не сломали ли мы существующую функциональность. Это также затрудняет рефакторинг и увеличивает время на ручное тестирование.

Отсутствие тестов делает изменение кода рискованным, так как невозможно быстро проверить, не сломали ли мы существующую функциональность. Это также затрудняет рефакторинг и увеличивает время на ручное тестирование.

## Возможные варианты решения

1. **Постепенное написание тестов**:
   - Сильные стороны: Минимальное влияние на текущую разработку, возможность начать с критических компонентов
   - Слабые стороны: Долгий процесс, код продолжает изменяться без тестового покрытия

2. **Блокировка изменений до написания тестов**:
   - Сильные стороны: Гарантированное тестовое покрытие для новых изменений, повышение качества кода
   - Слабые стороны: Замедление разработки, потенциальное сопротивление со стороны разработчиков

3. **Создание минимального набора тестов для критических путей**:
   - Сильные стороны: Быстрый старт, фокус на самых важных частях системы, возможность постепенного расширения
   - Слабые стороны: Неполное покрытие, необходимость определения критических путей

## Принятое решение / Компромисс
TODO: Необходимо определить стратегию внедрения тестов в проект. Рекомендуется начать с создания минимального набора тестов для критических компонентов (TgApiAccessor, BotManager) и постепенно расширять покрытие.

## Последствия
Если проблема будет решена путем внедрения тестов:
- Плюсы: Повышение качества кода, уверенность при изменениях, упрощение рефакторинга, документирование поведения кода
- Минусы: Временные затраты на написание тестов, необходимость поддержки тестов

Если проблема останется без изменений:
- Плюсы: Отсутствие временных затрат на написание тестов
- Минусы: Высокий риск внесения регрессий, длительное время на ручное тестирование, сложность рефакторинга, низкое качество кода, высокий риск внесения регрессий при изменениях, длительное время на ручное тестирование, сложность рефакторинга кода, низкое качество кода из-за отсутствия проверок, невозможность автоматической проверки качества изменений в CI/CD

## План исправления / развития
1. Создать структуру каталогов для тестов
2. Написать базовые unit-тесты для ключевых компонентов
3. Добавить интеграционные тесты для основных сценариев
4. Настроить запуск тестов в CI/CD pipeline
5. Добавить проверку покрытия кода тестами
6. Постепенно увеличивать покрытие тестами
7. В README.md также указан TODO по созданию структуры тестов

## Статус
Open

## Комментарии
В README.md также указан TODO по созданию структуры тестов. Отсутствие тестов является одной из самых серьезных проблем проекта, так как она влияет на все аспекты разработки и поддержки.

## TODO
Определить стратегию внедрения тестов в проект. Рекомендуется начать с создания минимального набора тестов для критических компонентов (TgApiAccessor, BotManager) и постепенно расширять покрытие.