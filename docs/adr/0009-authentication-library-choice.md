# 0009. Выбор библиотеки аутентификации

## Дата
2025-08-27

## Статус
Accepted

## Контекст
Для обеспечения безопасности доступа к админ-панели и потенциально к API необходимо определить подход к аутентификации.

Требования:
- Безопасность (хэширование паролей, защита от брутфорса)
- Интеграция с существующими компонентами
- Простота реализации
- Поддержка ролей и прав доступа

## Решение
Использовать встроенные механизмы аутентификации Django для админ-панели и кастомную реализацию для Telegram-бота.

### Админ-панель (Django):
1. Использование django.contrib.auth для аутентификации
2. Хранение пользователей в базе данных
3. Хэширование паролей с помощью PBKDF2
4. Сессии для отслеживания состояния аутентификации

### Telegram-бот:
1. Проверка пользователей по ID или роли в базе данных
2. Декоратор @only_admin для защиты endpoint'ов (уже реализован)
3. Хранение информации о пользователях и их ролях в БД

## Альтернативы
1. **JWT (JSON Web Tokens)**:
   - Плюсы: Stateless аутентификация, удобство для API
   - Минусы: Избыточность для текущих потребностей, необходимость реализации
   
2. **OAuth2**:
   - Плюсы: Стандартизированный подход, поддержка различных провайдеров
   - Минусы: Сложность реализации, избыточность для внутреннего инструмента
   
3. **Сторонние библиотеки (Authlib, Django REST Framework)**:
   - Плюсы: Готовые решения, расширяемость
   - Минусы: Дополнительные зависимости, потенциальная избыточность

## Последствия
**Положительные**:
- Использование проверенных решений (Django auth)
- Простота реализации для текущих потребностей
- Интеграция с существующей архитектурой
- Возможность расширения при необходимости

**Отрицательные**:
- Различные подходы к аутентификации для разных частей приложения
- Ограниченные возможности для сложных сценариев аутентификации

## Ретроспектива
Встроенные механизмы аутентификации Django работают хорошо. Для Telegram-бота достаточно простой проверки ролей в БД.

## Связанные ADR
- 0002. Ограничения доступа(Только для админов)