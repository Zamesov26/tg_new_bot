# 0008. Стратегия CI/CD

## Дата
2025-08-27

## Статус
Proposed

## Контекст
Для обеспечения качества кода и автоматизации процесса развертывания необходимо определить стратегию CI/CD.

Требования:
- Автоматический запуск тестов при каждом коммите
- Проверка кода на соответствие стандартам (linting)
- Автоматическое развертывание на staging/production
- Уведомления о результатах сборки
- Возможность отката изменений

## Решение
Использовать GitHub Actions для CI/CD pipeline.

### Этапы CI:
1. **Установка зависимостей**: Установка Python и необходимых пакетов
2. **Linting**: Проверка кода с помощью ruff
3. **Тестирование**: Запуск тестов с помощью pytest
4. **Сборка Docker-образов**: Создание образов для всех компонентов

### Этапы CD:
1. **Развертывание на staging**: При merge в ветку `develop`
2. **Развертывание на production**: При создании тега или merge в `main`

### Конфигурация:
Файлы в `.github/workflows/`:
- `ci.yml`: Непрерывная интеграция
- `cd-staging.yml`: Развертывание на staging
- `cd-production.yml`: Развертывание на production

## Альтернативы
1. **GitLab CI/CD**:
   - Плюсы: Интеграция с GitLab, мощные возможности
   - Минусы: Зависимость от GitLab, необходимость миграции репозитория
   
2. **Jenkins**:
   - Плюсы: Высокая гибкость, большое количество плагинов
   - Минусы: Сложность настройки и поддержки, необходимость отдельного сервера
   
3. **CircleCI/Travis CI**:
   - Плюсы: Облачные решения, быстрая настройка
   - Минусы: Ограничения бесплатного плана, зависимость от стороннего сервиса

## Последствия
**Положительные**:
- Автоматизация рутинных процессов
- Раннее выявление ошибок
- Единообразие процесса развертывания
- История изменений и возможность отката

**Отрицательные**:
- Необходимость настройки и поддержки pipeline'ов
- Потенциальное замедление процесса разработки при сложных проверках
- Зависимость от стороннего сервиса (GitHub)

## Ретроспектива
TODO: Заполнить после внедрения CI/CD

## Связанные ADR
- 0004. Стратегия развертывания
- 0007. Стратегия тестирования